### 前后分离

 此篇记录来源于。一般网页的公共部分怎么复用？



>  比如我们网站的公共部分 头部 和尾部 是很多地方都一样的。 所以我们怎么复用它？

现代网站中 基本上是没有静态页面的。 只要是个网站 都是有动态语言在处理请求 在渲染。 **在项目中用的是后端模板include逻辑**



> 前后分离？ 

**前后分离指的是: 后端(Server)负责Model层，提供数据。前端(Browser)负责Controller 和 View层。负责将数据渲染。 其实前后分离只是分离数据。前端只是一个骨架。浏览器加载页面后。脚本会向服务器拉数据** 。Header和Footer 不属于数据的范畴。 只是静态页面部分。 在后端include就OK 不需要前端去拉取。费时费力。



### 前后端分离思考 来自网易考拉

> SPA 前端路由方式代替后端的controller 使用前端模板代替后端模板引擎渲染 使用 restful API实现与后端的数据交互 前后端的交互被转成 纯粹的http方式的JSON串交互



### 优势

* 前端开发不需要启本地后端环境
* 独立的前端发开方式 由于后端返回纯JSON。前端想要模拟请求 只需要启动纯的静态服务器 响应JSON格式的html
* 联调 JSON非常清晰
* 用户体验上升





## 劣势

* SEO弱
* 首屏加载慢 (按需加载 CDN等等优化 减少请求)
* 权限控制也要交给前端来处理



开发阶段的 MOCK && Proxy



### 开发流程



> 接口定义

我们在接到需求之后，要实现某个功能。理清楚某个功能之后 应该与后端定义接口以及返回。

* 有哪些页面 页面的请求路径 模板位置 以及后端返回给我们的Model内容
* 有哪些Ajax 接口 Ajax接口的请求路径 以及后端返回的JSON内容

按照MOCK Server的要求。创建 MOCK文件 约定好JSON数据 与后端确认。，接口定义变成了一件很具体的事情，而开发阶段可以使用这份 Mock 数据，并做到 Mock 数据即接口文档



### Nodejs 中间层



nodejs中间件对应到设计模式的职责链模式、 即只处理自己能处理的情况。 否则就继续往后传递 知道被处理。 Proxy 作为中间件体系中的最后一层。 用来转发请求。 而在这之前依次是中间件的错误处理 静态资源的响应 路由拦截等。



### 前后分离的思考 文章来自淘宝FED



现在开发认为前后分离的例子是 SPA。 所有用到的展现数据都是后端通过异步接口(AjAX/JSONP)的方式提供。 前端只管展现。

> 两个问题
>
> * 在WEB服务中 SPA类占的比例较少 很多场景下还有同步 / 同步 + 异步 混合的模式。 SPA不能作为一种通用的解决方案
> * 现阶段 SPA开发模式 接口通常是按照展现逻辑提供。 有时候为了提高效率 后端会帮处理一些展现逻辑 意味着 后端还是涉足了View层的工作 不是真正的前后分离



SPA 式的前后分离只是从物理层区分。也就是说 客户端的就是前段 服务端就是后端。  我们应该从职责上划分才能满足我们的使用场景:

* 前端： 负责 View和 Controller层

* 后端：只负责Model层， 业务处理/数据

  ​









